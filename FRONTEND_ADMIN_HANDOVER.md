# ğŸ”§ æ ¡å›­è®ºå›åå°ç®¡ç†ç³»ç»Ÿå‰ç«¯å·¥ç¨‹å¸ˆäº¤æ¥æ–‡æ¡£

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
> **æœ€åæ›´æ–°**: 2025-11-15  
> **ç›®æ ‡å—ä¼—**: è´Ÿè´£å¼€å‘æ ¡å›­è®ºå›åå°ç®¡ç†ç³»ç»Ÿï¼ˆç®¡ç†å‘˜ä½¿ç”¨ï¼‰çš„å‰ç«¯å·¥ç¨‹å¸ˆ  
> **åç«¯ç‰ˆæœ¬**: v0.4.0  

---

## ğŸ“‹ ç›®å½•

- [1. é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
- [2. å¿«é€Ÿå¼€å§‹](#2-å¿«é€Ÿå¼€å§‹)
- [3. è®¤è¯ä¸æƒé™](#3-è®¤è¯ä¸æƒé™)
- [4. æ ¸å¿ƒç®¡ç†åŠŸèƒ½](#4-æ ¸å¿ƒç®¡ç†åŠŸèƒ½)
- [5. æ•°æ®ç»Ÿè®¡ä¸å¯è§†åŒ–](#5-æ•°æ®ç»Ÿè®¡ä¸å¯è§†åŒ–)
- [6. é”™è¯¯å¤„ç†](#6-é”™è¯¯å¤„ç†)
- [7. æœ€ä½³å®è·µ](#7-æœ€ä½³å®è·µ)
- [8. å¸¸è§é—®é¢˜](#8-å¸¸è§é—®é¢˜)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 ç®¡ç†ç«¯åŠŸèƒ½èŒƒå›´

æ ¡å›­è®ºå›åå°ç®¡ç†ç³»ç»Ÿæ˜¯é¢å‘**ç®¡ç†å‘˜ï¼ˆADMINï¼‰**çš„ Web åº”ç”¨ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

#### ç”¨æˆ·ç®¡ç†
- âœ… æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
- âœ… æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…
- âœ… å°ç¦/è§£å°ç”¨æˆ·
- âœ… ç”¨æˆ·ç»Ÿè®¡æ•°æ®

#### å†…å®¹ç®¡ç†
- âœ… æŸ¥çœ‹æ‰€æœ‰å¸–å­
- âœ… åˆ é™¤è¿è§„å¸–å­
- âœ… æŸ¥çœ‹æ‰€æœ‰è¯„è®º
- âœ… åˆ é™¤è¿è§„è¯„è®º

#### ä¸¾æŠ¥ç®¡ç†
- âœ… æŸ¥çœ‹ä¸¾æŠ¥åˆ—è¡¨
- âœ… å¤„ç†ä¸¾æŠ¥ï¼ˆé€šè¿‡/æ‹’ç»ï¼‰
- âœ… æŸ¥çœ‹ä¸¾æŠ¥è¯¦æƒ…
- âœ… æ·»åŠ å¤„ç†å¤‡æ³¨

#### æ•°æ®ç»Ÿè®¡
- âœ… ç”¨æˆ·å¢é•¿è¶‹åŠ¿
- âœ… å†…å®¹å‘å¸ƒè¶‹åŠ¿
- âœ… æ´»è·ƒåº¦ç»Ÿè®¡
- âœ… ä¸¾æŠ¥å¤„ç†ç»Ÿè®¡

#### ç³»ç»Ÿç®¡ç†
- âœ… å‘é€ç³»ç»Ÿé€šçŸ¥
- âœ… æ“ä½œæ—¥å¿—æŸ¥çœ‹
- âœ… ç³»ç»Ÿé…ç½®ç®¡ç†

### 1.2 æŠ€æœ¯æ ˆå»ºè®®

```json
{
  "æ¡†æ¶": "React 18+ / Vue 3+ / Next.js 14+",
  "ç®¡ç†åå°æ¡†æ¶": "Ant Design Pro / React Admin / Refine",
  "çŠ¶æ€ç®¡ç†": "Redux Toolkit / Zustand / Pinia",
  "è·¯ç”±": "React Router / Vue Router / Next.js App Router",
  "UIç»„ä»¶åº“": "Ant Design / Material-UI / Element Plus",
  "HTTPå®¢æˆ·ç«¯": "Axios",
  "å›¾è¡¨åº“": "ECharts / Recharts / Chart.js",
  "è¡¨æ ¼": "Ant Design Table / TanStack Table",
  "è¡¨å•éªŒè¯": "React Hook Form / VeeValidate",
  "å¯Œæ–‡æœ¬æŸ¥çœ‹": "react-markdown"
}
```

### 1.3 åç«¯ API åŸºç¡€ä¿¡æ¯

| é¡¹ç›® | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|------|---------|---------|
| **Base URL** | `http://localhost:3000/api/v1` | `https://api.yourdomain.com/api/v1` |
| **æ•°æ®æ ¼å¼** | JSON | JSON |
| **è®¤è¯æ–¹å¼** | JWT Bearer Token | JWT Bearer Token |
| **æƒé™è¦æ±‚** | ADMIN è§’è‰² | ADMIN è§’è‰² |

### 1.4 æƒé™è¯´æ˜

âš ï¸ **é‡è¦**: æ‰€æœ‰ç®¡ç†ç«¯æ¥å£éƒ½éœ€è¦ ADMIN è§’è‰²æƒé™ã€‚

- **æ³¨å†Œæ—¶è§’è‰²**: åªèƒ½æ³¨å†Œä¸º STUDENT æˆ– TEACHER
- **ç®¡ç†å‘˜åˆ›å»º**: éœ€è¦é€šè¿‡åç«¯è„šæœ¬åˆ›å»ºï¼ˆè§å¿«é€Ÿå¼€å§‹ï¼‰
- **æƒé™éªŒè¯**: åç«¯ä¼šéªŒè¯ JWT Token ä¸­çš„ `role` å­—æ®µ

---

## 2. å¿«é€Ÿå¼€å§‹

### 2.1 åˆ›å»ºç®¡ç†å‘˜è´¦å·

ç®¡ç†å‘˜è´¦å·éœ€è¦é€šè¿‡åç«¯å‘½ä»¤åˆ›å»ºï¼š

```bash
# åœ¨åç«¯é¡¹ç›®ç›®å½•
cd school-forum-back-end

# åˆ›å»ºç®¡ç†å‘˜è´¦å·
npm run create-admin
# æˆ–ä½¿ç”¨è„šæœ¬
node scripts/create-admin.js
```

æŒ‰æç¤ºè¾“å…¥ï¼š
- ç”¨æˆ·å
- é‚®ç®±
- å¯†ç 
- æ˜µç§°

### 2.2 å‰ç«¯é¡¹ç›®å¿«é€Ÿé›†æˆ

#### Step 1: å®‰è£…ä¾èµ–

```bash
# åŸºç¡€ä¾èµ–
npm install axios

# å¦‚æœä½¿ç”¨ Ant Design
npm install antd @ant-design/icons

# å›¾è¡¨åº“ï¼ˆå¯é€‰ï¼‰
npm install echarts echarts-for-react
```

#### Step 2: é…ç½® API å®¢æˆ·ç«¯

åˆ›å»º `src/api/client.ts`ï¼š

```typescript
import axios from 'axios';
import { message } from 'antd'; // å¦‚æœä½¿ç”¨ Ant Design

const apiClient = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api/v1',
  timeout: 15000, // ç®¡ç†ç«¯å¯èƒ½éœ€è¦æ›´é•¿çš„è¶…æ—¶æ—¶é—´
  withCredentials: true,
  headers: {
    'Content-Type': 'application/json',
  },
});

// è¯·æ±‚æ‹¦æˆªå™¨
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('adminAccessToken');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// å“åº”æ‹¦æˆªå™¨
apiClient.interceptors.response.use(
  (response) => response.data,
  async (error) => {
    const originalRequest = error.config;

    if (error.response?.status === 401 && !originalRequest._retry) {
      originalRequest._retry = true;

      try {
        const refreshToken = localStorage.getItem('adminRefreshToken');
        const response = await axios.post(
          `${apiClient.defaults.baseURL}/auth/refresh`,
          { refreshToken }
        );

        const { accessToken, refreshToken: newRefreshToken } = response.data.data;
        localStorage.setItem('adminAccessToken', accessToken);
        localStorage.setItem('adminRefreshToken', newRefreshToken);

        originalRequest.headers.Authorization = `Bearer ${accessToken}`;
        return apiClient(originalRequest);
      } catch (refreshError) {
        localStorage.clear();
        window.location.href = '/admin/login';
        return Promise.reject(refreshError);
      }
    }

    // 403 æƒé™ä¸è¶³
    if (error.response?.status === 403) {
      message.error('æƒé™ä¸è¶³ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•');
      window.location.href = '/admin/login';
    }

    return Promise.reject(error);
  }
);

export default apiClient;
```

#### Step 3: é…ç½®è·¯ç”±å®ˆå«

```typescript
// src/utils/auth.ts
export const isAdmin = (): boolean => {
  const user = localStorage.getItem('adminUser');
  if (!user) return false;
  
  try {
    const userData = JSON.parse(user);
    return userData.role === 'ADMIN';
  } catch {
    return false;
  }
};

export const requireAdmin = () => {
  if (!isAdmin()) {
    window.location.href = '/admin/login';
    throw new Error('éœ€è¦ç®¡ç†å‘˜æƒé™');
  }
};
```

---

## 3. è®¤è¯ä¸æƒé™

### 3.1 ç®¡ç†å‘˜ç™»å½•

**ç«¯ç‚¹**: `POST /auth/login`

```typescript
// src/api/auth.ts
import apiClient from './client';

interface LoginData {
  email: string;
  password: string;
}

export const adminLogin = async (data: LoginData) => {
  const response = await apiClient.post('/auth/login', data);
  
  const { user, accessToken, refreshToken } = response.data;
  
  // éªŒè¯æ˜¯å¦ä¸ºç®¡ç†å‘˜
  if (user.role !== 'ADMIN') {
    throw new Error('æƒé™ä¸è¶³ï¼Œéœ€è¦ç®¡ç†å‘˜è´¦å·');
  }
  
  // ä¿å­˜ Token å’Œç”¨æˆ·ä¿¡æ¯
  localStorage.setItem('adminAccessToken', accessToken);
  localStorage.setItem('adminRefreshToken', refreshToken);
  localStorage.setItem('adminUser', JSON.stringify(user));
  
  return response;
};
```

#### React ç™»å½•ç»„ä»¶ç¤ºä¾‹

```tsx
// src/pages/admin/Login.tsx
import { useState } from 'react';
import { Form, Input, Button, message } from 'antd';
import { UserOutlined, LockOutlined } from '@ant-design/icons';
import { adminLogin } from '../../api/auth';

const AdminLogin = () => {
  const [loading, setLoading] = useState(false);

  const onFinish = async (values: any) => {
    setLoading(true);
    try {
      await adminLogin(values);
      message.success('ç™»å½•æˆåŠŸ');
      window.location.href = '/admin/dashboard';
    } catch (error: any) {
      message.error(error.response?.data?.message || 'ç™»å½•å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="admin-login-container">
      <div className="login-box">
        <h1>æ ¡å›­è®ºå›ç®¡ç†åå°</h1>
        <Form onFinish={onFinish} size="large">
          <Form.Item
            name="email"
            rules={[
              { required: true, message: 'è¯·è¾“å…¥é‚®ç®±' },
              { type: 'email', message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±' },
            ]}
          >
            <Input
              prefix={<UserOutlined />}
              placeholder="ç®¡ç†å‘˜é‚®ç®±"
            />
          </Form.Item>
          <Form.Item
            name="password"
            rules={[{ required: true, message: 'è¯·è¾“å…¥å¯†ç ' }]}
          >
            <Input.Password
              prefix={<LockOutlined />}
              placeholder="å¯†ç "
            />
          </Form.Item>
          <Form.Item>
            <Button type="primary" htmlType="submit" loading={loading} block>
              ç™»å½•
            </Button>
          </Form.Item>
        </Form>
      </div>
    </div>
  );
};

export default AdminLogin;
```

### 3.2 æƒé™éªŒè¯ä¸­é—´ä»¶

```typescript
// src/components/AdminRoute.tsx
import { Navigate } from 'react-router-dom';
import { isAdmin } from '../utils/auth';

interface AdminRouteProps {
  children: React.ReactNode;
}

const AdminRoute: React.FC<AdminRouteProps> = ({ children }) => {
  if (!isAdmin()) {
    return <Navigate to="/admin/login" replace />;
  }

  return <>{children}</>;
};

export default AdminRoute;
```

---

## 4. æ ¸å¿ƒç®¡ç†åŠŸèƒ½

### 4.1 ç”¨æˆ·ç®¡ç†

#### 4.1.1 è·å–ç”¨æˆ·åˆ—è¡¨

**ç«¯ç‚¹**: `GET /admin/users` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/users.ts
interface UsersQuery {
  page?: number;
  limit?: number;
  role?: 'STUDENT' | 'TEACHER' | 'ADMIN';
  isBanned?: boolean;
  search?: string; // æœç´¢ç”¨æˆ·åæˆ–é‚®ç®±
}

export const getUsers = async (query: UsersQuery = {}) => {
  return await apiClient.get('/admin/users', { params: query });
};
```

#### React ç»„ä»¶ç¤ºä¾‹

```tsx
// src/pages/admin/UserManagement.tsx
import { useState, useEffect } from 'react';
import { Table, Button, Tag, Space, Modal, message } from 'antd';
import { getUsers, banUser, unbanUser } from '../../api/admin/users';

const UserManagement = () => {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(false);
  const [pagination, setPagination] = useState({
    current: 1,
    pageSize: 20,
    total: 0,
  });

  const fetchUsers = async (page = 1) => {
    setLoading(true);
    try {
      const response = await getUsers({ page, limit: 20 });
      setUsers(response.data);
      setPagination({
        current: page,
        pageSize: 20,
        total: response.meta.total,
      });
    } catch (error) {
      message.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchUsers();
  }, []);

  const handleBanUser = (userId: string, isBanned: boolean) => {
    Modal.confirm({
      title: isBanned ? 'ç¡®è®¤è§£å°ç”¨æˆ·ï¼Ÿ' : 'ç¡®è®¤å°ç¦ç”¨æˆ·ï¼Ÿ',
      content: isBanned ? 'è§£å°åç”¨æˆ·å¯ä»¥æ­£å¸¸ä½¿ç”¨' : 'å°ç¦åç”¨æˆ·å°†æ— æ³•ç™»å½•',
      onOk: async () => {
        try {
          if (isBanned) {
            await unbanUser(userId);
            message.success('è§£å°æˆåŠŸ');
          } else {
            await banUser(userId);
            message.success('å°ç¦æˆåŠŸ');
          }
          fetchUsers(pagination.current);
        } catch (error) {
          message.error('æ“ä½œå¤±è´¥');
        }
      },
    });
  };

  const columns = [
    {
      title: 'ID',
      dataIndex: 'id',
      key: 'id',
      width: 100,
      ellipsis: true,
    },
    {
      title: 'ç”¨æˆ·å',
      dataIndex: 'username',
      key: 'username',
    },
    {
      title: 'é‚®ç®±',
      dataIndex: 'email',
      key: 'email',
    },
    {
      title: 'æ˜µç§°',
      dataIndex: 'nickname',
      key: 'nickname',
    },
    {
      title: 'è§’è‰²',
      dataIndex: 'role',
      key: 'role',
      render: (role: string) => {
        const colorMap: any = {
          ADMIN: 'red',
          TEACHER: 'blue',
          STUDENT: 'green',
        };
        return <Tag color={colorMap[role]}>{role}</Tag>;
      },
    },
    {
      title: 'çŠ¶æ€',
      key: 'status',
      render: (record: any) => {
        if (record.isBanned) {
          return <Tag color="red">å·²å°ç¦</Tag>;
        }
        return <Tag color="green">æ­£å¸¸</Tag>;
      },
    },
    {
      title: 'æ³¨å†Œæ—¶é—´',
      dataIndex: 'createdAt',
      key: 'createdAt',
      render: (date: string) => new Date(date).toLocaleString('zh-CN'),
    },
    {
      title: 'æ“ä½œ',
      key: 'action',
      render: (record: any) => (
        <Space>
          <Button type="link" size="small">
            æŸ¥çœ‹è¯¦æƒ…
          </Button>
          <Button
            type="link"
            size="small"
            danger={!record.isBanned}
            onClick={() => handleBanUser(record.id, record.isBanned)}
          >
            {record.isBanned ? 'è§£å°' : 'å°ç¦'}
          </Button>
        </Space>
      ),
    },
  ];

  return (
    <div>
      <h1>ç”¨æˆ·ç®¡ç†</h1>
      <Table
        columns={columns}
        dataSource={users}
        loading={loading}
        rowKey="id"
        pagination={{
          ...pagination,
          onChange: (page) => fetchUsers(page),
        }}
      />
    </div>
  );
};

export default UserManagement;
```

#### 4.1.2 å°ç¦/è§£å°ç”¨æˆ·

**ç«¯ç‚¹**: `POST /admin/users/:id/ban` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/users.ts
export const banUser = async (userId: string) => {
  return await apiClient.post(`/admin/users/${userId}/ban`);
};

export const unbanUser = async (userId: string) => {
  return await apiClient.post(`/admin/users/${userId}/unban`);
};
```

#### 4.1.3 è·å–ç”¨æˆ·è¯¦æƒ…

**ç«¯ç‚¹**: `GET /admin/users/:id` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/users.ts
export const getUserDetail = async (userId: string) => {
  return await apiClient.get(`/admin/users/${userId}`);
};
```

### 4.2 å†…å®¹ç®¡ç†

#### 4.2.1 è·å–æ‰€æœ‰å¸–å­

**ç«¯ç‚¹**: `GET /admin/posts` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/posts.ts
interface PostsQuery {
  page?: number;
  limit?: number;
  isDeleted?: boolean;
  authorId?: string;
  sortBy?: 'createdAt' | 'viewCount' | 'likeCount';
}

export const getAllPosts = async (query: PostsQuery = {}) => {
  return await apiClient.get('/admin/posts', { params: query });
};
```

#### 4.2.2 åˆ é™¤å¸–å­

**ç«¯ç‚¹**: `DELETE /admin/posts/:id` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/posts.ts
export const deletePost = async (postId: string, reason?: string) => {
  return await apiClient.delete(`/admin/posts/${postId}`, {
    data: { reason },
  });
};
```

#### 4.2.3 è·å–æ‰€æœ‰è¯„è®º

**ç«¯ç‚¹**: `GET /admin/comments` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/comments.ts
export const getAllComments = async (page = 1, limit = 20) => {
  return await apiClient.get('/admin/comments', {
    params: { page, limit },
  });
};
```

#### 4.2.4 åˆ é™¤è¯„è®º

**ç«¯ç‚¹**: `DELETE /admin/comments/:id` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/comments.ts
export const deleteComment = async (commentId: string) => {
  return await apiClient.delete(`/admin/comments/${commentId}`);
};
```

### 4.3 ä¸¾æŠ¥ç®¡ç†

#### 4.3.1 è·å–ä¸¾æŠ¥åˆ—è¡¨

**ç«¯ç‚¹**: `GET /admin/reports` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/reports.ts
interface ReportsQuery {
  page?: number;
  limit?: number;
  status?: 'PENDING' | 'APPROVED' | 'REJECTED';
  targetType?: 'POST' | 'COMMENT' | 'USER';
}

export const getReports = async (query: ReportsQuery = {}) => {
  return await apiClient.get('/admin/reports', { params: query });
};
```

#### React ç»„ä»¶ç¤ºä¾‹

```tsx
// src/pages/admin/ReportManagement.tsx
import { useState, useEffect } from 'react';
import { Table, Button, Tag, Space, Modal, Input, message } from 'antd';
import { getReports, handleReport } from '../../api/admin/reports';

const { TextArea } = Input;

const ReportManagement = () => {
  const [reports, setReports] = useState([]);
  const [loading, setLoading] = useState(false);
  const [modalVisible, setModalVisible] = useState(false);
  const [currentReport, setCurrentReport] = useState<any>(null);
  const [handleNote, setHandleNote] = useState('');

  const fetchReports = async (status?: string) => {
    setLoading(true);
    try {
      const response = await getReports({ status, page: 1, limit: 50 });
      setReports(response.data);
    } catch (error) {
      message.error('è·å–ä¸¾æŠ¥åˆ—è¡¨å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchReports('PENDING'); // é»˜è®¤åªæ˜¾ç¤ºå¾…å¤„ç†çš„
  }, []);

  const showHandleModal = (report: any) => {
    setCurrentReport(report);
    setModalVisible(true);
  };

  const handleReportAction = async (action: 'APPROVED' | 'REJECTED') => {
    try {
      await handleReport(currentReport.id, {
        status: action,
        handleNote,
      });
      message.success(action === 'APPROVED' ? 'å·²é€šè¿‡ä¸¾æŠ¥' : 'å·²æ‹’ç»ä¸¾æŠ¥');
      setModalVisible(false);
      setHandleNote('');
      fetchReports('PENDING');
    } catch (error) {
      message.error('æ“ä½œå¤±è´¥');
    }
  };

  const columns = [
    {
      title: 'ä¸¾æŠ¥ID',
      dataIndex: 'id',
      key: 'id',
      width: 100,
      ellipsis: true,
    },
    {
      title: 'ä¸¾æŠ¥ç±»å‹',
      dataIndex: 'targetType',
      key: 'targetType',
      render: (type: string) => {
        const typeMap: any = {
          POST: 'å¸–å­',
          COMMENT: 'è¯„è®º',
          USER: 'ç”¨æˆ·',
        };
        return <Tag>{typeMap[type]}</Tag>;
      },
    },
    {
      title: 'ä¸¾æŠ¥åŸå› ',
      dataIndex: 'reason',
      key: 'reason',
      ellipsis: true,
    },
    {
      title: 'ä¸¾æŠ¥äºº',
      dataIndex: 'reporter',
      key: 'reporter',
      render: (reporter: any) => reporter.username,
    },
    {
      title: 'çŠ¶æ€',
      dataIndex: 'status',
      key: 'status',
      render: (status: string) => {
        const colorMap: any = {
          PENDING: 'orange',
          APPROVED: 'green',
          REJECTED: 'red',
        };
        const textMap: any = {
          PENDING: 'å¾…å¤„ç†',
          APPROVED: 'å·²é€šè¿‡',
          REJECTED: 'å·²æ‹’ç»',
        };
        return <Tag color={colorMap[status]}>{textMap[status]}</Tag>;
      },
    },
    {
      title: 'ä¸¾æŠ¥æ—¶é—´',
      dataIndex: 'createdAt',
      key: 'createdAt',
      render: (date: string) => new Date(date).toLocaleString('zh-CN'),
    },
    {
      title: 'æ“ä½œ',
      key: 'action',
      render: (record: any) => (
        <Space>
          <Button
            type="link"
            size="small"
            onClick={() => showHandleModal(record)}
            disabled={record.status !== 'PENDING'}
          >
            å¤„ç†
          </Button>
          <Button type="link" size="small">
            æŸ¥çœ‹è¯¦æƒ…
          </Button>
        </Space>
      ),
    },
  ];

  return (
    <div>
      <h1>ä¸¾æŠ¥ç®¡ç†</h1>
      <Space style={{ marginBottom: 16 }}>
        <Button onClick={() => fetchReports('PENDING')}>å¾…å¤„ç†</Button>
        <Button onClick={() => fetchReports('APPROVED')}>å·²é€šè¿‡</Button>
        <Button onClick={() => fetchReports('REJECTED')}>å·²æ‹’ç»</Button>
        <Button onClick={() => fetchReports()}>å…¨éƒ¨</Button>
      </Space>
      <Table
        columns={columns}
        dataSource={reports}
        loading={loading}
        rowKey="id"
      />

      <Modal
        title="å¤„ç†ä¸¾æŠ¥"
        open={modalVisible}
        onCancel={() => setModalVisible(false)}
        footer={[
          <Button key="cancel" onClick={() => setModalVisible(false)}>
            å–æ¶ˆ
          </Button>,
          <Button
            key="reject"
            onClick={() => handleReportAction('REJECTED')}
          >
            æ‹’ç»ä¸¾æŠ¥
          </Button>,
          <Button
            key="approve"
            type="primary"
            danger
            onClick={() => handleReportAction('APPROVED')}
          >
            é€šè¿‡ä¸¾æŠ¥
          </Button>,
        ]}
      >
        <p><strong>ä¸¾æŠ¥ç±»å‹ï¼š</strong>{currentReport?.targetType}</p>
        <p><strong>ä¸¾æŠ¥åŸå› ï¼š</strong>{currentReport?.reason}</p>
        <TextArea
          rows={4}
          placeholder="å¤„ç†å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰"
          value={handleNote}
          onChange={(e) => setHandleNote(e.target.value)}
        />
      </Modal>
    </div>
  );
};

export default ReportManagement;
```

#### 4.3.2 å¤„ç†ä¸¾æŠ¥

**ç«¯ç‚¹**: `PATCH /admin/reports/:id` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/reports.ts
interface HandleReportData {
  status: 'APPROVED' | 'REJECTED';
  handleNote?: string;
}

export const handleReport = async (reportId: string, data: HandleReportData) => {
  return await apiClient.patch(`/admin/reports/${reportId}`, data);
};
```

### 4.4 ç³»ç»Ÿé€šçŸ¥

#### 4.4.1 å‘é€ç³»ç»Ÿé€šçŸ¥

**ç«¯ç‚¹**: `POST /admin/notifications/broadcast` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/notifications.ts
interface BroadcastData {
  title: string;
  content: string;
  targetUsers?: string[]; // ä¸æä¾›åˆ™å‘é€ç»™æ‰€æœ‰ç”¨æˆ·
}

export const sendBroadcastNotification = async (data: BroadcastData) => {
  return await apiClient.post('/admin/notifications/broadcast', data);
};
```

#### React ç»„ä»¶ç¤ºä¾‹

```tsx
// src/pages/admin/SendNotification.tsx
import { useState } from 'react';
import { Form, Input, Button, message } from 'antd';
import { sendBroadcastNotification } from '../../api/admin/notifications';

const SendNotification = () => {
  const [form] = Form.useForm();
  const [loading, setLoading] = useState(false);

  const onFinish = async (values: any) => {
    setLoading(true);
    try {
      await sendBroadcastNotification(values);
      message.success('é€šçŸ¥å‘é€æˆåŠŸ');
      form.resetFields();
    } catch (error) {
      message.error('å‘é€å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div>
      <h1>å‘é€ç³»ç»Ÿé€šçŸ¥</h1>
      <Form
        form={form}
        onFinish={onFinish}
        layout="vertical"
        style={{ maxWidth: 600 }}
      >
        <Form.Item
          label="é€šçŸ¥æ ‡é¢˜"
          name="title"
          rules={[{ required: true, message: 'è¯·è¾“å…¥æ ‡é¢˜' }]}
        >
          <Input placeholder="è¾“å…¥é€šçŸ¥æ ‡é¢˜" />
        </Form.Item>
        <Form.Item
          label="é€šçŸ¥å†…å®¹"
          name="content"
          rules={[{ required: true, message: 'è¯·è¾“å…¥å†…å®¹' }]}
        >
          <Input.TextArea rows={6} placeholder="è¾“å…¥é€šçŸ¥å†…å®¹" />
        </Form.Item>
        <Form.Item>
          <Button type="primary" htmlType="submit" loading={loading}>
            å‘é€ç»™æ‰€æœ‰ç”¨æˆ·
          </Button>
        </Form.Item>
      </Form>
    </div>
  );
};

export default SendNotification;
```

---

## 5. æ•°æ®ç»Ÿè®¡ä¸å¯è§†åŒ–

### 5.1 è·å–ç»Ÿè®¡æ•°æ®

**ç«¯ç‚¹**: `GET /admin/statistics` ğŸ”’ éœ€è¦ ADMIN æƒé™

```typescript
// src/api/admin/statistics.ts
interface StatisticsQuery {
  startDate?: string;
  endDate?: string;
  type?: 'user' | 'post' | 'comment' | 'report';
}

export const getStatistics = async (query: StatisticsQuery = {}) => {
  return await apiClient.get('/admin/statistics', { params: query });
};

// è·å–æ¦‚è§ˆæ•°æ®
export const getOverview = async () => {
  return await apiClient.get('/admin/statistics/overview');
};
```

#### React ç»„ä»¶ç¤ºä¾‹ï¼ˆä½¿ç”¨ EChartsï¼‰

```tsx
// src/pages/admin/Dashboard.tsx
import { useState, useEffect } from 'react';
import { Row, Col, Card, Statistic } from 'antd';
import { UserOutlined, FileTextOutlined, CommentOutlined } from '@ant-design/icons';
import ReactECharts from 'echarts-for-react';
import { getOverview, getStatistics } from '../../api/admin/statistics';

const Dashboard = () => {
  const [overview, setOverview] = useState<any>({});
  const [userGrowth, setUserGrowth] = useState([]);

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    try {
      const overviewData = await getOverview();
      setOverview(overviewData.data);

      const statsData = await getStatistics({
        type: 'user',
        startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),
        endDate: new Date().toISOString(),
      });
      setUserGrowth(statsData.data);
    } catch (error) {
      console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
    }
  };

  const getUserGrowthOption = () => ({
    title: {
      text: 'ç”¨æˆ·å¢é•¿è¶‹åŠ¿ï¼ˆæœ€è¿‘30å¤©ï¼‰',
    },
    tooltip: {
      trigger: 'axis',
    },
    xAxis: {
      type: 'category',
      data: userGrowth.map((item: any) => item.date),
    },
    yAxis: {
      type: 'value',
    },
    series: [
      {
        name: 'æ–°å¢ç”¨æˆ·',
        type: 'line',
        data: userGrowth.map((item: any) => item.count),
        smooth: true,
        areaStyle: {},
      },
    ],
  });

  return (
    <div>
      <h1>æ•°æ®æ¦‚è§ˆ</h1>
      <Row gutter={16}>
        <Col span={6}>
          <Card>
            <Statistic
              title="æ€»ç”¨æˆ·æ•°"
              value={overview.totalUsers}
              prefix={<UserOutlined />}
            />
          </Card>
        </Col>
        <Col span={6}>
          <Card>
            <Statistic
              title="æ€»å¸–å­æ•°"
              value={overview.totalPosts}
              prefix={<FileTextOutlined />}
            />
          </Card>
        </Col>
        <Col span={6}>
          <Card>
            <Statistic
              title="æ€»è¯„è®ºæ•°"
              value={overview.totalComments}
              prefix={<CommentOutlined />}
            />
          </Card>
        </Col>
        <Col span={6}>
          <Card>
            <Statistic
              title="å¾…å¤„ç†ä¸¾æŠ¥"
              value={overview.pendingReports}
              valueStyle={{ color: '#cf1322' }}
            />
          </Card>
        </Col>
      </Row>

      <Card style={{ marginTop: 16 }}>
        <ReactECharts option={getUserGrowthOption()} style={{ height: 400 }} />
      </Card>
    </div>
  );
};

export default Dashboard;
```

---

## 6. é”™è¯¯å¤„ç†

### 6.1 é”™è¯¯å“åº”æ ¼å¼

```json
{
  "statusCode": 403,
  "message": "æƒé™ä¸è¶³",
  "error": "Forbidden",
  "timestamp": "2025-11-15T12:00:00.000Z",
  "path": "/api/v1/admin/users"
}
```

### 6.2 å¸¸è§é”™è¯¯ç 

| çŠ¶æ€ç  | è¯´æ˜ | å¤„ç†æ–¹å¼ |
|-------|------|---------|
| 401 | æœªæˆæƒï¼ˆæœªç™»å½•æˆ– Token å¤±æ•ˆï¼‰ | è·³è½¬åˆ°ç®¡ç†å‘˜ç™»å½•é¡µ |
| 403 | ç¦æ­¢è®¿é—®ï¼ˆé ADMIN è§’è‰²ï¼‰ | æ˜¾ç¤º"æƒé™ä¸è¶³"æç¤ºï¼Œè·³è½¬ç™»å½•é¡µ |
| 404 | èµ„æºä¸å­˜åœ¨ | æ˜¾ç¤º"å†…å®¹ä¸å­˜åœ¨" |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æ˜¾ç¤º"æœåŠ¡å™¨é”™è¯¯" |

### 6.3 å…¨å±€é”™è¯¯å¤„ç†

```typescript
// src/utils/errorHandler.ts
import { message } from 'antd';

export const handleAdminError = (error: any) => {
  if (error.response) {
    const { status, data } = error.response;

    switch (status) {
      case 401:
        message.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
        localStorage.clear();
        window.location.href = '/admin/login';
        break;
      case 403:
        message.error('æƒé™ä¸è¶³ï¼Œè¯·ä½¿ç”¨ç®¡ç†å‘˜è´¦å·');
        window.location.href = '/admin/login';
        break;
      case 404:
        message.error('èµ„æºä¸å­˜åœ¨');
        break;
      case 500:
        message.error('æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åå†è¯•');
        break;
      default:
        message.error(data.message || 'æœªçŸ¥é”™è¯¯');
    }
  } else {
    message.error('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥');
  }
};
```

---

## 7. æœ€ä½³å®è·µ

### 7.1 å¸ƒå±€ç»“æ„

æ¨èä½¿ç”¨ç»å…¸çš„ç®¡ç†åå°å¸ƒå±€ï¼š

```tsx
// src/layouts/AdminLayout.tsx
import { Layout, Menu } from 'antd';
import {
  DashboardOutlined,
  UserOutlined,
  FileTextOutlined,
  WarningOutlined,
  SettingOutlined,
} from '@ant-design/icons';

const { Header, Sider, Content } = Layout;

const AdminLayout = ({ children }: { children: React.ReactNode }) => {
  return (
    <Layout style={{ minHeight: '100vh' }}>
      <Sider>
        <div className="logo" />
        <Menu theme="dark" mode="inline" defaultSelectedKeys={['1']}>
          <Menu.Item key="1" icon={<DashboardOutlined />}>
            æ•°æ®æ¦‚è§ˆ
          </Menu.Item>
          <Menu.Item key="2" icon={<UserOutlined />}>
            ç”¨æˆ·ç®¡ç†
          </Menu.Item>
          <Menu.Item key="3" icon={<FileTextOutlined />}>
            å†…å®¹ç®¡ç†
          </Menu.Item>
          <Menu.Item key="4" icon={<WarningOutlined />}>
            ä¸¾æŠ¥ç®¡ç†
          </Menu.Item>
          <Menu.Item key="5" icon={<SettingOutlined />}>
            ç³»ç»Ÿè®¾ç½®
          </Menu.Item>
        </Menu>
      </Sider>
      <Layout>
        <Header style={{ background: '#fff', padding: '0 24px' }}>
          <h2>æ ¡å›­è®ºå›ç®¡ç†åå°</h2>
        </Header>
        <Content style={{ margin: '24px 16px', padding: 24, background: '#fff' }}>
          {children}
        </Content>
      </Layout>
    </Layout>
  );
};

export default AdminLayout;
```

### 7.2 è¡¨æ ¼ä¼˜åŒ–

1. **åˆ†é¡µ**: å§‹ç»ˆä½¿ç”¨åˆ†é¡µï¼Œé¿å…ä¸€æ¬¡åŠ è½½è¿‡å¤šæ•°æ®
2. **æœç´¢ä¸ç­›é€‰**: æä¾›æœç´¢æ¡†å’Œç­›é€‰å™¨
3. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ é™¤ã€æ‰¹é‡å®¡æ ¸ç­‰
4. **å¯¼å‡ºåŠŸèƒ½**: æä¾›æ•°æ®å¯¼å‡ºåŠŸèƒ½

### 7.3 æ“ä½œç¡®è®¤

å¯¹äºæ•æ„Ÿæ“ä½œï¼ˆåˆ é™¤ã€å°ç¦ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨ç¡®è®¤å¯¹è¯æ¡†ï¼š

```tsx
import { Modal } from 'antd';

const confirmDelete = (id: string) => {
  Modal.confirm({
    title: 'ç¡®è®¤åˆ é™¤ï¼Ÿ',
    content: 'æ­¤æ“ä½œä¸å¯æ¢å¤',
    okText: 'ç¡®è®¤',
    okType: 'danger',
    cancelText: 'å–æ¶ˆ',
    onOk: async () => {
      await deletePost(id);
      message.success('åˆ é™¤æˆåŠŸ');
    },
  });
};
```

### 7.4 æƒé™æ§åˆ¶

åœ¨ç»„ä»¶çº§åˆ«æ§åˆ¶æƒé™ï¼š

```tsx
// src/components/PermissionGuard.tsx
import { isAdmin } from '../utils/auth';

interface PermissionGuardProps {
  children: React.ReactNode;
  fallback?: React.ReactNode;
}

const PermissionGuard: React.FC<PermissionGuardProps> = ({ 
  children, 
  fallback = null 
}) => {
  return isAdmin() ? <>{children}</> : <>{fallback}</>;
};

export default PermissionGuard;
```

---

## 8. å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼Ÿ

**A**: ç®¡ç†å‘˜è´¦å·åªèƒ½é€šè¿‡åç«¯è„šæœ¬åˆ›å»ºï¼Œä¸èƒ½é€šè¿‡æ³¨å†Œæ¥å£åˆ›å»ºã€‚

```bash
npm run create-admin
# æˆ–
node scripts/create-admin.js
```

### Q2: ç™»å½•åæç¤º"æƒé™ä¸è¶³"ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®è®¤è´¦å·çš„ `role` å­—æ®µä¸º `ADMIN`
2. æ£€æŸ¥ JWT Token æ˜¯å¦æœ‰æ•ˆ
3. æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤æƒé™éªŒè¯é€»è¾‘

### Q3: å¦‚ä½•åŒºåˆ†ç®¡ç†ç«¯å’Œç”¨æˆ·ç«¯çš„ Tokenï¼Ÿ

**A**: å»ºè®®ä½¿ç”¨ä¸åŒçš„ localStorage keyï¼š
- ç®¡ç†ç«¯: `adminAccessToken`, `adminRefreshToken`, `adminUser`
- ç”¨æˆ·ç«¯: `accessToken`, `refreshToken`, `user`

### Q4: å¦‚ä½•å¤„ç†æ•°æ®é‡å¤§çš„è¡¨æ ¼ï¼Ÿ

**A**: 
1. ä½¿ç”¨æœåŠ¡ç«¯åˆ†é¡µï¼ˆå¿…éœ€ï¼‰
2. ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¯é€‰ï¼Œé’ˆå¯¹è¶…å¤§æ•°æ®ï¼‰
3. æ·»åŠ æœç´¢å’Œç­›é€‰åŠŸèƒ½
4. è€ƒè™‘å¯¼å‡ºåŠŸèƒ½è€Œä¸æ˜¯ä¸€æ¬¡æ€§æ˜¾ç¤ºå…¨éƒ¨

### Q5: å¦‚ä½•å®ç°æ“ä½œæ—¥å¿—ï¼Ÿ

**A**: åç«¯å¯èƒ½æä¾›æ“ä½œæ—¥å¿—æ¥å£ï¼š

```typescript
// src/api/admin/logs.ts
export const getOperationLogs = async (page = 1, limit = 50) => {
  return await apiClient.get('/admin/logs', {
    params: { page, limit },
  });
};
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´ API æ–‡æ¡£](./02-implementation/api-documentation.md)
- [åç«¯æ¶æ„è®¾è®¡](./01-design/architecture-design.md)
- [æƒé™ç³»ç»Ÿè¯´æ˜](./PERMISSIONS.md)
- [æ•…éšœæ’æŸ¥æŒ‡å—](./TROUBLESHOOTING.md)

---

## ğŸ¯ æ€»ç»“

æœ¬æ–‡æ¡£æ¶µç›–äº†æ ¡å›­è®ºå›åå°ç®¡ç†ç³»ç»Ÿå‰ç«¯å¼€å‘çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š

âœ… ç®¡ç†å‘˜è®¤è¯ä¸æƒé™éªŒè¯  
âœ… ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ã€å°ç¦ã€è§£å°ï¼‰  
âœ… å†…å®¹ç®¡ç†ï¼ˆå¸–å­ã€è¯„è®ºï¼‰  
âœ… ä¸¾æŠ¥ç®¡ç†ï¼ˆæŸ¥çœ‹ã€å¤„ç†ï¼‰  
âœ… ç³»ç»Ÿé€šçŸ¥å‘é€  
âœ… æ•°æ®ç»Ÿè®¡ä¸å¯è§†åŒ–  
âœ… é”™è¯¯å¤„ç†  
âœ… æœ€ä½³å®è·µ  

**ä¸‹ä¸€æ­¥**ï¼šå‚è€ƒæœ¬æ–‡æ¡£å¿«é€Ÿæ­å»ºç®¡ç†åå°åº”ç”¨ï¼Œé‡åˆ°é—®é¢˜æŸ¥çœ‹[æ•…éšœæ’æŸ¥æŒ‡å—](./TROUBLESHOOTING.md)æˆ–è”ç³»åç«¯å›¢é˜Ÿã€‚

---

**æ–‡æ¡£ç»´æŠ¤è€…**: åç«¯å¼€å‘å›¢é˜Ÿ  
**è”ç³»æ–¹å¼**: support@example.com  
**æœ€åæ›´æ–°**: 2025-11-15
