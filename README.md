# ğŸ“š æ ¡å›­è®ºå›åå°ç³»ç»Ÿ

> **NestJS + PostgreSQL + Redis + é˜¿é‡Œäº‘**  
> ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ ¡å›­ç¤¾äº¤è®ºå›åç«¯ç³»ç»Ÿ

---

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
- [æ–‡æ¡£å¯¼èˆª](#æ–‡æ¡£å¯¼èˆª)

---

## é¡¹ç›®ç®€ä»‹

æ ¡å›­è®ºå›åå°ç³»ç»Ÿæ˜¯åŸºäº **NestJS** æ¡†æ¶å¼€å‘çš„ RESTful API æœåŠ¡ï¼Œä¸ºæ ¡å›­ç”¨æˆ·æä¾›å‘å¸–ã€è¯„è®ºã€ç‚¹èµã€æœç´¢ç­‰ç¤¾äº¤äº’åŠ¨åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒæ°´å¹³æ‰©å±•å’Œå¾®æœåŠ¡åŒ–æ¼”è¿›ã€‚

### ç‰¹ç‚¹

- âœ… **æ¨¡å—åŒ–è®¾è®¡**ï¼š8+ æ ¸å¿ƒæ¨¡å—ï¼ŒèŒè´£æ¸…æ™°
- âœ… **ç±»å‹å®‰å…¨**ï¼šTypeScript + Prisma å…¨æ ˆç±»å‹å®‰å…¨
- âœ… **é«˜æ€§èƒ½**ï¼šRedis ç¼“å­˜ + æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- âœ… **å®‰å…¨å¯é **ï¼šJWT è®¤è¯ + è§’è‰²æƒé™æ§åˆ¶
- âœ… **äº‘åŸç”Ÿ**ï¼šæ”¯æŒé˜¿é‡Œäº‘ ECS/RDS/Redis/OSS éƒ¨ç½²
- âœ… **å®æ—¶é€šçŸ¥**ï¼šWebSocket å®æ—¶æ¨é€
- âœ… **å®Œæ•´æ–‡æ¡£**ï¼šAPI æ–‡æ¡£ + å¼€å‘æŒ‡å— + éƒ¨ç½²æŒ‡å—

---

## æ ¸å¿ƒåŠŸèƒ½

### ç”¨æˆ·åŠŸèƒ½
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•ï¼ˆJWT è®¤è¯ï¼‰
- ä¸ªäººèµ„æ–™ç®¡ç†
- å…³æ³¨/ç²‰ä¸ç³»ç»Ÿ
- ä¸ªæ€§åŒ–æ¨è

### å†…å®¹åŠŸèƒ½
- å¸–å­å‘å¸ƒ/ç¼–è¾‘/åˆ é™¤
- è¯„è®ºä¸äºŒçº§å›å¤
- ç‚¹èµ/æ”¶è—
- è‰ç¨¿è‡ªåŠ¨ä¿å­˜
- å›¾ç‰‡ä¸Šä¼ ï¼ˆé˜¿é‡Œäº‘ OSSï¼‰

### ç¤¾äº¤åŠŸèƒ½
- å…¨æ–‡æœç´¢
- çƒ­é—¨/è¶‹åŠ¿æ¨è
- è¯é¢˜æ ‡ç­¾
- å®æ—¶é€šçŸ¥

### ç®¡ç†åŠŸèƒ½
- ç”¨æˆ·ç®¡ç†ï¼ˆå°ç¦/è§£å°ï¼‰
- å†…å®¹å®¡æ ¸
- ä¸¾æŠ¥å¤„ç†
- æ•°æ®ç»Ÿè®¡

---

## æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **NestJS** v11 - æ¸è¿›å¼ Node.js æ¡†æ¶
- **TypeScript** v5.7 - ç±»å‹å®‰å…¨
- **Prisma** - ç°ä»£åŒ– ORM

### æ•°æ®åº“
- **PostgreSQL** 14+ - ä¸»æ•°æ®åº“
- **Redis** 6.0+ - ç¼“å­˜ä¸ Session

### è®¤è¯ä¸å®‰å…¨
- **JWT** - æ— çŠ¶æ€è®¤è¯
- **Passport** - è®¤è¯ä¸­é—´ä»¶
- **bcrypt** - å¯†ç åŠ å¯†

### äº‘æœåŠ¡ï¼ˆé˜¿é‡Œäº‘ï¼‰
- **ECS** - åº”ç”¨æœåŠ¡å™¨
- **RDS PostgreSQL** - æ‰˜ç®¡æ•°æ®åº“
- **Redis** - æ‰˜ç®¡ç¼“å­˜
- **OSS** - å¯¹è±¡å­˜å‚¨
- **CDN** - å†…å®¹åˆ†å‘

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Client Layer                         â”‚
â”‚              (Web / Mobile / Desktop)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/HTTPS
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Layer (NestJS)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Auth    â”‚  â”‚  Posts   â”‚  â”‚  Users   â”‚             â”‚
â”‚  â”‚  Module  â”‚  â”‚  Module  â”‚  â”‚  Module  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Comments â”‚  â”‚  Likes   â”‚  â”‚  Search  â”‚             â”‚
â”‚  â”‚  Module  â”‚  â”‚  Module  â”‚  â”‚  Module  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL   â”‚ â”‚  Redis  â”‚ â”‚ Ali OSS   â”‚
â”‚   (RDS)      â”‚ â”‚ (Cache) â”‚ â”‚  (File)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—

| æ¨¡å— | èŒè´£ | ä¾èµ– |
|-----|------|------|
| `auth` | ç”¨æˆ·è®¤è¯ã€æ³¨å†Œã€ç™»å½• | `prisma`, `users` |
| `users` | ç”¨æˆ·ä¿¡æ¯ç®¡ç† | `prisma` |
| `posts` | å¸–å­ CRUD | `prisma`, `users` |
| `comments` | è¯„è®ºåŠŸèƒ½ | `prisma`, `posts` |
| `likes` | ç‚¹èµåŠŸèƒ½ | `prisma` |
| `notifications` | é€šçŸ¥æ¨é€ | `prisma`, `users` |
| `admin` | ç®¡ç†å‘˜åŠŸèƒ½ | `prisma` |
| `search` | å…¨æ–‡æœç´¢ | `prisma` |

---

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

```bash
node -v    # >= 18.0.0
pnpm -v    # >= 8.0.0
psql --version  # PostgreSQL >= 14
redis-cli --version  # Redis >= 6.0
```

### 2. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd school-forum-back-end
```

### 3. å®‰è£…ä¾èµ–

```bash
pnpm install
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
vim .env
```

**å…³é”®é…ç½®**ï¼š
```env
# æ•°æ®åº“
DATABASE_URL="postgresql://user:password@localhost:5432/school_forum"

# JWT
JWT_SECRET=your-secret-key-min-32-chars
JWT_REFRESH_SECRET=your-refresh-secret-key

# Redis
REDIS_HOST=127.0.0.1
REDIS_PORT=6379

# CORS
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:5173,http://localhost:5174
```

### 5. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”Ÿæˆ Prisma Client
pnpm prisma generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm prisma migrate dev

# (å¯é€‰) å¡«å……æµ‹è¯•æ•°æ®
pnpm prisma db seed
```

### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm run start:dev
```

åº”ç”¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

### 7. éªŒè¯å®‰è£…

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:3000

# æŸ¥çœ‹ Prisma Studio
pnpm prisma studio
```

---

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ auth/                       # è®¤è¯æ¨¡å—
â”œâ”€â”€ users/                      # ç”¨æˆ·æ¨¡å—
â”œâ”€â”€ posts/                      # å¸–å­æ¨¡å—
â”œâ”€â”€ comments/                   # è¯„è®ºæ¨¡å—
â”œâ”€â”€ likes/                      # ç‚¹èµæ¨¡å—
â”œâ”€â”€ notifications/              # é€šçŸ¥æ¨¡å—
â”œâ”€â”€ search/                     # æœç´¢æ¨¡å—
â”œâ”€â”€ admin/                      # ç®¡ç†æ¨¡å—
â”œâ”€â”€ favorites/                  # æ”¶è—æ¨¡å—
â”œâ”€â”€ follows/                    # å…³æ³¨æ¨¡å—
â”œâ”€â”€ drafts/                     # è‰ç¨¿æ¨¡å—
â”œâ”€â”€ recommendations/            # æ¨èæ¨¡å—
â”‚
â”œâ”€â”€ common/                     # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ decorators/             # è£…é¥°å™¨
â”‚   â”œâ”€â”€ guards/                 # å®ˆå«
â”‚   â”œâ”€â”€ filters/                # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ interceptors/           # æ‹¦æˆªå™¨
â”‚   â””â”€â”€ middleware/             # ä¸­é—´ä»¶
â”‚
â”œâ”€â”€ prisma/                     # Prisma æœåŠ¡
â”œâ”€â”€ redis/                      # Redis æœåŠ¡
â”œâ”€â”€ app.module.ts               # æ ¹æ¨¡å—
â””â”€â”€ main.ts                     # åº”ç”¨å…¥å£
```

---

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### users (ç”¨æˆ·è¡¨)
- id (PK, UUID)
- username (å”¯ä¸€ç´¢å¼•)
- email (å”¯ä¸€ç´¢å¼•)
- password (åŠ å¯†)
- role (USER/ADMIN)
- created_at, updated_at

#### posts (å¸–å­è¡¨)
- id (PK, UUID)
- title (å…¨æ–‡ç´¢å¼•)
- content (å…¨æ–‡ç´¢å¼•)
- author_id (FK â†’ users.id)
- tags (æ•°ç»„)
- view_count, like_count, comment_count
- created_at, updated_at

#### comments (è¯„è®ºè¡¨)
- id (PK, UUID)
- content
- post_id (FK â†’ posts.id)
- author_id (FK â†’ users.id)
- parent_id (FK â†’ comments.id, å¯ç©º)
- created_at, updated_at

#### likes (ç‚¹èµè¡¨)
- id (PK, UUID)
- user_id (FK â†’ users.id)
- target_id
- target_type (POST/COMMENT)
- UNIQUE(user_id, target_id, target_type)

### æ‰©å±•åŠŸèƒ½è¡¨
- **favorites** - æ”¶è—
- **follows** - å…³æ³¨
- **post_drafts** - è‰ç¨¿
- **notifications** - é€šçŸ¥
- **reports** - ä¸¾æŠ¥

---

## æ–‡æ¡£å¯¼èˆª

### ğŸ“– æ ¸å¿ƒæ–‡æ¡£ï¼ˆå¿…è¯»ï¼‰

1. **[DEVELOPMENT.md](./DEVELOPMENT.md)** - å¼€å‘æŒ‡å—
   - å¼€å‘ç¯å¢ƒæ­å»º
   - API æ¥å£æ–‡æ¡£
   - æ•°æ®åº“ä½¿ç”¨æŒ‡å—
   - ä»£ç è§„èŒƒä¸æœ€ä½³å®è·µ

2. **[DEPLOYMENT.md](./DEPLOYMENT.md)** - éƒ¨ç½²æŒ‡å—
   - é˜¿é‡Œäº‘èµ„æºé…ç½®
   - æœåŠ¡å™¨ç¯å¢ƒæ­å»º
   - åº”ç”¨éƒ¨ç½²æµç¨‹
   - æ•…éšœæ’æŸ¥ä¸è¿ç»´

### ğŸ“ å‰ç«¯å¯¹æ¥æ–‡æ¡£

- **[FRONTEND_USER_HANDOVER.md](./FRONTEND_USER_HANDOVER.md)** - ç”¨æˆ·ç«¯å‰ç«¯äº¤æ¥
- **[FRONTEND_ADMIN_HANDOVER.md](./FRONTEND_ADMIN_HANDOVER.md)** - ç®¡ç†ç«¯å‰ç«¯äº¤æ¥

### ğŸ”— å¿«é€Ÿé“¾æ¥

- **å¼€å‘ç¯å¢ƒæ­å»º** â†’ [DEVELOPMENT.md#å¿«é€Ÿå¼€å§‹](./DEVELOPMENT.md)
- **API æ¥å£æ–‡æ¡£** â†’ [DEVELOPMENT.md#APIæ–‡æ¡£](./DEVELOPMENT.md)
- **æ•°æ®åº“è¿ç§»** â†’ [DEVELOPMENT.md#æ•°æ®åº“ä½¿ç”¨](./DEVELOPMENT.md)
- **éƒ¨ç½²åˆ°é˜¿é‡Œäº‘** â†’ [DEPLOYMENT.md#éƒ¨ç½²æµç¨‹](./DEPLOYMENT.md)
- **å¸¸è§é—®é¢˜æ’æŸ¥** â†’ [DEPLOYMENT.md#æ•…éšœæ’æŸ¥](./DEPLOYMENT.md)

---

## å¼€å‘å›¢é˜Ÿ

- **é¡¹ç›®è´Ÿè´£äºº**: åç«¯å¼€å‘å›¢é˜Ÿ
- **æŠ€æœ¯æ”¯æŒ**: support@example.com
- **é—®é¢˜åé¦ˆ**: GitHub Issues
- **æœ€åæ›´æ–°**: 2025-11-16

---

<div align="center">

**ğŸš€ å¼€å§‹å¼€å‘**: é˜…è¯» [DEVELOPMENT.md](./DEVELOPMENT.md)  
**â˜ï¸ éƒ¨ç½²ä¸Šçº¿**: é˜…è¯» [DEPLOYMENT.md](./DEPLOYMENT.md)

Made with â¤ï¸ by åç«¯å¼€å‘å›¢é˜Ÿ

</div>
