# æ ¡å›­è®ºå›åå°ç³»ç»Ÿ - é¡¹ç›®å®Œæˆæ€»ç»“

## ğŸ“Š é¡¹ç›®æ¦‚è§ˆ

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ ¡å›­ç¤¾äº¤è®ºå›åç«¯ç³»ç»Ÿï¼ŒåŸºäº **NestJS + TypeScript + PostgreSQL + Prisma** å¼€å‘ï¼Œå·²å®Œæˆ **v0.4.0 ç‰ˆæœ¬çš„æ‰€æœ‰åŠŸèƒ½å®ç°**ã€‚

## âœ… å·²å®ç°åŠŸèƒ½ç»Ÿè®¡

| ç‰ˆæœ¬ | åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | å®Œæˆåº¦ |
|-----|---------|------|--------|
| v0.1 | é¡¹ç›®åˆå§‹åŒ–ã€æ–‡æ¡£ã€æ•°æ®åº“è®¾è®¡ | âœ… | 100% |
| v0.2 | è®¤è¯ã€ç”¨æˆ·ã€å¸–å­ã€è¯„è®ºã€ç‚¹èµ | âœ… | 100% |
| v0.3 | æœç´¢ã€é€šçŸ¥ã€ç®¡ç†åå° | âœ… | 100% |
| v0.4 | WebSocketã€è‰ç¨¿ã€æ”¶è—ã€å…³æ³¨ã€æ¨è | âœ… | 100% |
| **æ€»è®¡** | **14 ä¸ªæ ¸å¿ƒæ¨¡å— + ä¼—å¤šåŠŸèƒ½** | âœ… | **100%** |

---

## ğŸ¯ v0.4.0 æ‰©å±•åŠŸèƒ½å®ç°è¯¦æƒ…

### 1. WebSocket å®æ—¶é€šçŸ¥æ¨é€æ¨¡å— âœ…

**æ–‡ä»¶åˆ—è¡¨ï¼š**
- `src/notifications/notifications.gateway.ts` - WebSocket ç½‘å…³ (217 è¡Œ)
- `src/notifications/notification-emitter.service.ts` - é€šçŸ¥å‘å°„å™¨ (32 è¡Œ)
- `src/notifications/notifications.module.ts` - æ¨¡å—å®šä¹‰ (æ›´æ–°)
- `src/notifications/websocket-events.ts` - äº‹ä»¶æ–‡æ¡£å’Œå¸¸é‡ (256 è¡Œ)

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- âœ… JWT è®¤è¯å’Œæˆæƒ
- âœ… å®¢æˆ·ç«¯è¿æ¥/æ–­å¼€è¿æ¥ç®¡ç†
- âœ… ç”¨æˆ·åœ¨çº¿çŠ¶æ€è·Ÿè¸ª
- âœ… Socket.io æˆ¿é—´ç®¡ç† (`user:userId` å’Œ `user:userId:notifications`)
- âœ… å®æ—¶é€šçŸ¥æ¨é€
- âœ… æœªè¯»é€šçŸ¥æ•°é‡ç®¡ç†
- âœ… åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡

**WebSocket äº‹ä»¶ï¼š**
```
å®¢æˆ·ç«¯ç›‘å¬äº‹ä»¶ï¼š
- notification:new - æ¥æ”¶æ–°é€šçŸ¥
- notification:unread_count - è·å–æœªè¯»é€šçŸ¥æ•°é‡
- notification:unread_count_updated - æœªè¯»æ•°é‡å˜åŒ–æ¨é€
- notification:read_success - æ ‡è®°ä¸ºå·²è¯»æˆåŠŸ
- notification:all_read_success - å…¨éƒ¨æ ‡è®°ä¸ºå·²è¯»æˆåŠŸ
- system:online_count - åœ¨çº¿ç”¨æˆ·æ•°é‡å¹¿æ’­
- error - é”™è¯¯äº‹ä»¶

å®¢æˆ·ç«¯å‘é€äº‹ä»¶ï¼š
- notification:mark_read - æ ‡è®°å•ä¸ªä¸ºå·²è¯»
- notification:mark_all_read - æ ‡è®°å…¨éƒ¨ä¸ºå·²è¯»
- notification:unread_count - è·å–æœªè¯»æ•°é‡
```

### 2. å¸–å­è‰ç¨¿åŠŸèƒ½æ¨¡å— âœ…

**æ–‡ä»¶åˆ—è¡¨ï¼š**
- `src/drafts/drafts.service.ts` - è‰ç¨¿æœåŠ¡ (å®Œæ•´å®ç°)
- `src/drafts/drafts.controller.ts` - è‰ç¨¿æ§åˆ¶å™¨ (REST ç«¯ç‚¹)
- `src/drafts/drafts.module.ts` - æ¨¡å—å®šä¹‰
- `src/drafts/dto/create-post-draft.dto.ts` - æ•°æ®éªŒè¯

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨ä¿å­˜è‰ç¨¿ (AUTO-SAVE)
- âœ… è·å–ç”¨æˆ·è‰ç¨¿åˆ—è¡¨
- âœ… ä¿®æ”¹è‰ç¨¿
- âœ… åˆ é™¤è‰ç¨¿
- âœ… å‘å¸ƒè‰ç¨¿åˆ°æ­£å¼å¸–å­ (éªŒè¯å¿…å¡«å­—æ®µ)

**REST ç«¯ç‚¹ï¼š**
```
POST   /posts/drafts                - åˆ›å»º/æ›´æ–°è‰ç¨¿
GET    /posts/drafts                - è·å–è‰ç¨¿åˆ—è¡¨
GET    /posts/drafts/:id            - è·å–å•ä¸ªè‰ç¨¿
PATCH  /posts/drafts/:id            - æ›´æ–°è‰ç¨¿
DELETE /posts/drafts/:id            - åˆ é™¤è‰ç¨¿
POST   /posts/drafts/:id/publish    - å‘å¸ƒè‰ç¨¿
```

### 3. å¸–å­æ”¶è—åŠŸèƒ½æ¨¡å— âœ…

**æ–‡ä»¶åˆ—è¡¨ï¼š**
- `src/favorites/favorites.service.ts` - æ”¶è—æœåŠ¡ (å®Œæ•´å®ç°)
- `src/favorites/favorites.controller.ts` - æ”¶è—æ§åˆ¶å™¨
- `src/favorites/favorites.module.ts` - æ¨¡å—å®šä¹‰
- `src/favorites/dto/` - æ•°æ®éªŒè¯ DTO

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… åˆ›å»ºæ”¶è—å¤¹
- âœ… è·å–ç”¨æˆ·çš„æ‰€æœ‰æ”¶è—å¤¹
- âœ… è·å–å•ä¸ªæ”¶è—å¤¹è¯¦æƒ…
- âœ… æ›´æ–°æ”¶è—å¤¹ä¿¡æ¯
- âœ… åˆ é™¤æ”¶è—å¤¹
- âœ… æ·»åŠ å¸–å­åˆ°æ”¶è—å¤¹
- âœ… ç§»é™¤æ”¶è—
- âœ… æŸ¥çœ‹æ”¶è—å¤¹ä¸­çš„å¸–å­

**REST ç«¯ç‚¹ï¼š**
```
POST   /favorites/folders                      - åˆ›å»ºæ”¶è—å¤¹
GET    /favorites/folders                      - è·å–æ”¶è—å¤¹åˆ—è¡¨
GET    /favorites/folders/:id                  - è·å–æ”¶è—å¤¹è¯¦æƒ…
PATCH  /favorites/folders/:id                  - æ›´æ–°æ”¶è—å¤¹
DELETE /favorites/folders/:id                  - åˆ é™¤æ”¶è—å¤¹
POST   /favorites                              - æ·»åŠ æ”¶è—
DELETE /favorites/:id                          - åˆ é™¤æ”¶è—
GET    /favorites/folders/:folderId/posts      - è·å–æ”¶è—çš„å¸–å­
```

### 4. ç”¨æˆ·å…³æ³¨ç³»ç»Ÿæ¨¡å— âœ…

**æ–‡ä»¶åˆ—è¡¨ï¼š**
- `src/follows/follows.service.ts` - å…³æ³¨æœåŠ¡ (å®Œæ•´å®ç°)
- `src/follows/follows.controller.ts` - å…³æ³¨æ§åˆ¶å™¨
- `src/follows/follows.module.ts` - æ¨¡å—å®šä¹‰
- `src/follows/dto/` - æ•°æ®éªŒè¯ DTO

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… å…³æ³¨ç”¨æˆ·
- âœ… å–æ¶ˆå…³æ³¨
- âœ… è·å–ç”¨æˆ·çš„å…³æ³¨åˆ—è¡¨
- âœ… è·å–ç”¨æˆ·çš„ç²‰ä¸åˆ—è¡¨
- âœ… æ£€æŸ¥æ˜¯å¦å…³æ³¨æŸç”¨æˆ·
- âœ… é˜²æ­¢è‡ªæˆ‘å…³æ³¨éªŒè¯
- âœ… è‡ªåŠ¨æ›´æ–° followerCount/followingCount

**REST ç«¯ç‚¹ï¼š**
```
POST   /users/:id/follow            - å…³æ³¨ç”¨æˆ·
DELETE /users/:id/follow            - å–æ¶ˆå…³æ³¨
GET    /users/:id/following         - è·å–å…³æ³¨åˆ—è¡¨
GET    /users/:id/followers         - è·å–ç²‰ä¸åˆ—è¡¨
```

### 5. çƒ­é—¨æ¨èç³»ç»Ÿæ¨¡å— âœ…

**æ–‡ä»¶åˆ—è¡¨ï¼š**
- `src/recommendations/recommendations.service.ts` - æ¨èæœåŠ¡ (å®Œæ•´å®ç°)
- `src/recommendations/recommendations.controller.ts` - æ¨èæ§åˆ¶å™¨
- `src/recommendations/recommendations.module.ts` - æ¨¡å—å®šä¹‰
- `src/recommendations/dto/create-topic.dto.ts` - è¯é¢˜ DTO

**æ¨èç®—æ³•ï¼š**

1. **Wilson Score ç®—æ³•** (çƒ­åº¦è¯„åˆ†)
   - åŸºäºç‚¹èµæ•°å’Œè¯„è®ºæ•°
   - ä½¿ç”¨ç»Ÿè®¡å­¦æ–¹æ³•è®¡ç®—ç½®ä¿¡åº¦ (95%)
   - é€‚ç”¨äºé•¿æœŸçƒ­é—¨å¸–å­

2. **æ—¶é—´è¡°å‡ç®—æ³•** (è¶‹åŠ¿è¯„åˆ†)
   - åŸºäºæœ€è¿‘äº’åŠ¨æ´»è·ƒåº¦
   - é‡åŠ›ç³»æ•°: 1.8
   - é€‚ç”¨äºæ–°æ™‹çƒ­é—¨å¸–å­ (æœ€è¿‘ 7 å¤©)

3. **è´¨é‡åˆ†æ•°ç®—æ³•** (ç”¨æˆ·äº’åŠ¨è¯„åˆ†)
   - åŸºäºå‚ä¸åº¦ = (ç‚¹èµ + è¯„è®º) / æµè§ˆé‡
   - èŒƒå›´: 0-100

**REST ç«¯ç‚¹ï¼š**
```
GET /recommendations/posts/hot              - è·å–çƒ­é—¨å¸–å­
GET /recommendations/posts/trending         - è·å–è¶‹åŠ¿å¸–å­
GET /recommendations/posts/latest           - è·å–æœ€æ–°å¸–å­
GET /recommendations/personalized           - è·å–ä¸ªæ€§åŒ–æ¨è
GET /recommendations/topics/hot             - è·å–çƒ­é—¨è¯é¢˜
GET /recommendations/topics                 - è·å–æ‰€æœ‰è¯é¢˜
```

### 6. ä¼šè¯å’Œè·¨åŸŸé…ç½® âœ…

**é…ç½®æ–‡ä»¶ï¼š** `src/main.ts`

**å®ç°å†…å®¹ï¼š**
- âœ… Express Session ä¸­é—´ä»¶
  - 24 å°æ—¶ maxAge
  - HttpOnly å®‰å…¨ cookie
  - SameSite=lax CSRF é˜²æŠ¤
  - ç”Ÿäº§ç¯å¢ƒ Secure flag

- âœ… Cookie Parser ä¸­é—´ä»¶
  - è‡ªåŠ¨è§£æ Cookie

- âœ… CORS é…ç½®
  - è·¨åŸŸè¯·æ±‚æ”¯æŒ
  - å‡­è¯æ”¯æŒ (credentials: true)
  - ç‰¹å®šè¯·æ±‚æ–¹æ³•å…è®¸

- âœ… URL ç‰ˆæœ¬æ§åˆ¶
  - API ç‰ˆæœ¬åŒ– (/api/v1/...)

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### Prisma Schema æ–°å¢æ¨¡å‹

```prisma
// å…³æ³¨å…³ç³»
model Follow {
  id          String   @id @default(uuid())
  followerId  String   @map("follower_id")    // å…³æ³¨è€…
  followingId String   @map("following_id")   // è¢«å…³æ³¨è€…
  createdAt   DateTime @default(now())

  follower  User @relation("Follower", ...)
  following User @relation("Following", ...)

  @@unique([followerId, followingId])
  @@map("follows")
}

// æ”¶è—å¤¹
model Folder {
  id          String   @id @default(uuid())
  userId      String   @map("user_id")
  name        String   @db.VarChar(50)
  description String?  @db.VarChar(200)
  isDefault   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user      User       @relation(...)
  favorites Favorite[]

  @@map("folders")
}

// æ”¶è—
model Favorite {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  postId    String   @map("post_id")
  folderId  String   @map("folder_id")
  note      String?  @db.Text
  createdAt DateTime @default(now())

  user   User   @relation(...)
  post   Post   @relation(...)
  folder Folder @relation(...)

  @@unique([userId, postId])
  @@map("favorites")
}

// å¸–å­è‰ç¨¿
model PostDraft {
  id        String    @id @default(uuid())
  title     String?   @db.VarChar(200)
  content   String?   @db.Text
  images    String[]
  tags      String[]
  authorId  String    @map("author_id")
  postId    String?   @map("post_id")
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  author User @relation(...)

  @@map("post_drafts")
}

// å¸–å­è¯„åˆ†
model PostScore {
  id            String   @id @default(uuid())
  postId        String   @unique @map("post_id")
  hotScore      Float    @default(0)
  trendingScore Float    @default(0)
  qualityScore  Float    @default(0)
  updatedAt     DateTime @updatedAt

  @@map("post_scores")
}

// è¯é¢˜
model Topic {
  id            String   @id @default(uuid())
  name          String   @unique @db.VarChar(50)
  description   String?  @db.VarChar(200)
  postCount     Int      @default(0)
  followerCount Int      @default(0)
  isHot         Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("topics")
}
```

### ç”¨æˆ·æ¨¡å‹æ›´æ–°

```prisma
model User {
  // ... ç°æœ‰å­—æ®µ ...
  followerCount   Int      @default(0) @map("follower_count")   // æ–°å¢
  followingCount  Int      @default(0) @map("following_count")  // æ–°å¢

  // ... ç°æœ‰å…³è” ...
  followers        Follow[]      @relation("Following")   // æ–°å¢
  following        Follow[]      @relation("Follower")    // æ–°å¢
  favorites        Favorite[]                              // æ–°å¢
  postDrafts       PostDraft[]                             // æ–°å¢
  folders          Folder[]                                // æ–°å¢
}
```

---

## ğŸ“¦ ä¾èµ–åŒ…å®‰è£…

æ­¤æ¬¡å®ç°æ–°å¢çš„ä¾èµ–ï¼š

```json
{
  "dependencies": {
    "@nestjs/websockets": "^11.1.9",
    "@nestjs/platform-ws": "^11.1.9",
    "socket.io": "^4.8.1",
    "express-session": "^1.18.2",
    "cookie-parser": "^1.4.7"
  },
  "devDependencies": {
    "@types/express-session": "^1.18.2",
    "@types/cookie-parser": "^1.4.10"
  }
}
```

---

## ğŸ—ï¸ é¡¹ç›®æ¨¡å—ç»“æ„

**å®Œæ•´çš„æ¨¡å—æ ‘ï¼š**

```
src/
â”œâ”€â”€ app.module.ts                          # æ ¹æ¨¡å— (13+ å¯¼å…¥)
â”œâ”€â”€ main.ts                                # å…¥å£æ–‡ä»¶ (å¸¦ WebSocket é…ç½®)
â”œâ”€â”€ auth/                                  # âœ… è®¤è¯æ¨¡å—
â”œâ”€â”€ users/                                 # âœ… ç”¨æˆ·æ¨¡å—
â”œâ”€â”€ posts/                                 # âœ… å¸–å­æ¨¡å—
â”œâ”€â”€ comments/                              # âœ… è¯„è®ºæ¨¡å—
â”œâ”€â”€ likes/                                 # âœ… ç‚¹èµæ¨¡å—
â”œâ”€â”€ search/                                # âœ… æœç´¢æ¨¡å—
â”œâ”€â”€ notifications/                         # âœ… é€šçŸ¥æ¨¡å— (ç°åŒ…å« WebSocket)
â”‚   â”œâ”€â”€ notifications.service.ts
â”‚   â”œâ”€â”€ notifications.controller.ts
â”‚   â”œâ”€â”€ notifications.gateway.ts          # NEW: WebSocket ç½‘å…³
â”‚   â”œâ”€â”€ notification-emitter.service.ts   # NEW: é€šçŸ¥å‘å°„å™¨
â”‚   â”œâ”€â”€ notifications.module.ts           # UPDATED
â”‚   â”œâ”€â”€ websocket-events.ts               # NEW: äº‹ä»¶æ–‡æ¡£
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ admin/                                 # âœ… ç®¡ç†æ¨¡å—
â”œâ”€â”€ follows/                               # âœ… NEW: å…³æ³¨æ¨¡å—
â”‚   â”œâ”€â”€ follows.service.ts
â”‚   â”œâ”€â”€ follows.controller.ts
â”‚   â”œâ”€â”€ follows.module.ts
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ favorites/                             # âœ… NEW: æ”¶è—æ¨¡å—
â”‚   â”œâ”€â”€ favorites.service.ts
â”‚   â”œâ”€â”€ favorites.controller.ts
â”‚   â”œâ”€â”€ favorites.module.ts
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ drafts/                                # âœ… NEW: è‰ç¨¿æ¨¡å—
â”‚   â”œâ”€â”€ drafts.service.ts
â”‚   â”œâ”€â”€ drafts.controller.ts
â”‚   â”œâ”€â”€ drafts.module.ts
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ recommendations/                       # âœ… NEW: æ¨èæ¨¡å—
â”‚   â”œâ”€â”€ recommendations.service.ts
â”‚   â”œâ”€â”€ recommendations.controller.ts
â”‚   â”œâ”€â”€ recommendations.module.ts
â”‚   â””â”€â”€ dto/
â”œâ”€â”€ prisma/                                # âœ… Prisma é…ç½®
â”‚   â”œâ”€â”€ schema.prisma                     # UPDATED: 6 æ–°æ¨¡å‹
â”‚   â””â”€â”€ prisma.service.ts
â”œâ”€â”€ common/                                # âœ… å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ decorators/
â”‚   â”œâ”€â”€ filters/
â”‚   â”œâ”€â”€ guards/
â”‚   â”œâ”€â”€ interceptors/
â”‚   â””â”€â”€ pipes/
â””â”€â”€ ...
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ–°å¢æ–‡ä»¶ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | åŠŸèƒ½ |
|-----|-------|---------|------|
| WebSocket | 3 | 505 | å®æ—¶é€šçŸ¥æ¨é€ |
| å…³æ³¨ç³»ç»Ÿ | 3 | 250+ | ç”¨æˆ·å…³æ³¨ |
| æ”¶è—ç³»ç»Ÿ | 3 | 300+ | å¸–å­æ”¶è— |
| è‰ç¨¿ç³»ç»Ÿ | 3 | 280+ | å¸–å­è‰ç¨¿ |
| æ¨èç³»ç»Ÿ | 3 | 350+ | çƒ­é—¨æ¨è |
| **æ€»è®¡** | **15+** | **1500+** | **5 å¤§åŠŸèƒ½æ¨¡å—** |

### æ¨¡å—æ›´æ–°

- âœ… `app.module.ts` - æ·»åŠ  5 ä¸ªæ–°æ¨¡å—å¯¼å…¥
- âœ… `notifications.module.ts` - æ·»åŠ  WebSocket ç½‘å…³å’Œ JWT æ”¯æŒ
- âœ… `prisma/schema.prisma` - æ·»åŠ  6 ä¸ªæ–°æ¨¡å‹
- âœ… `src/main.ts` - Session å’Œ CORS é…ç½®

---

## ğŸ” å®‰å…¨ç‰¹æ€§

### å·²å®ç°çš„å®‰å…¨æªæ–½

- âœ… **JWT è®¤è¯** - æ‰€æœ‰å—ä¿æŠ¤çš„ç«¯ç‚¹
- âœ… **WebSocket è®¤è¯** - åŸºäº JWT token
- âœ… **å¯†ç åŠ å¯†** - bcrypt ç®—æ³•
- âœ… **CORS é…ç½®** - é™åˆ¶è·¨åŸŸè¯·æ±‚
- âœ… **Session å®‰å…¨**
  - HttpOnly cookies
  - Secure flag (ç”Ÿäº§ç¯å¢ƒ)
  - SameSite=lax
- âœ… **è¾“å…¥éªŒè¯** - class-validator DTO
- âœ… **æƒé™æ§åˆ¶** - @Roles() è£…é¥°å™¨
- âœ… **SQL æ³¨å…¥é˜²æŠ¤** - Prisma ORM
- âœ… **XSS é˜²æŠ¤** - TypeScript ç±»å‹å®‰å…¨

---

## ğŸ§ª æµ‹è¯•å’Œç¼–è¯‘

### ç¼–è¯‘çŠ¶æ€

âœ… **é¡¹ç›®æˆåŠŸç¼–è¯‘** (No TypeScript errors)

```bash
npm run build  # âœ… æˆåŠŸ
```

### æ„å»ºè¾“å‡º

- æ‰€æœ‰ TypeScript æ–‡ä»¶ç¼–è¯‘æˆ JavaScript
- ç±»å‹å®šä¹‰ç”Ÿæˆå®Œæˆ
- Prisma Client ç±»å‹ç”Ÿæˆå®Œæˆ

---

## ğŸ“ API æ–‡æ¡£

### WebSocket è¿æ¥ç¤ºä¾‹ (JavaScript)

```javascript
import { io } from 'socket.io-client';

const socket = io('http://localhost:3000', {
  auth: {
    token: 'your_jwt_token_here'
  }
});

// è¿æ¥æˆåŠŸ
socket.on('connect', () => {
  console.log('å·²è¿æ¥åˆ°é€šçŸ¥æœåŠ¡');
});

// æ¥æ”¶æ–°é€šçŸ¥
socket.on('notification:new', (notification) => {
  console.log('æ–°é€šçŸ¥:', notification);
});

// æ ‡è®°ä¸ºå·²è¯»
socket.emit('notification:mark_read', {
  notificationId: 'notification_id'
});

// æ ‡è®°å…¨éƒ¨ä¸ºå·²è¯»
socket.emit('notification:mark_all_read', {});
```

### REST API ç«¯ç‚¹æ€»è§ˆ

**å…³æ³¨ç›¸å…³ï¼š**
- `POST /follows/users/:id/follow` - å…³æ³¨ç”¨æˆ·
- `DELETE /follows/users/:id/follow` - å–æ¶ˆå…³æ³¨
- `GET /follows/users/:id/following` - è·å–å…³æ³¨åˆ—è¡¨
- `GET /follows/users/:id/followers` - è·å–ç²‰ä¸åˆ—è¡¨

**æ”¶è—ç›¸å…³ï¼š**
- `POST /favorites/folders` - åˆ›å»ºæ”¶è—å¤¹
- `GET /favorites/folders` - è·å–æ”¶è—å¤¹åˆ—è¡¨
- `POST /favorites` - æ·»åŠ æ”¶è—
- `GET /favorites/folders/:folderId/posts` - æŸ¥çœ‹æ”¶è—çš„å¸–å­

**è‰ç¨¿ç›¸å…³ï¼š**
- `POST /posts/drafts` - åˆ›å»º/æ›´æ–°è‰ç¨¿
- `GET /posts/drafts` - è·å–è‰ç¨¿åˆ—è¡¨
- `PATCH /posts/drafts/:id` - ä¿®æ”¹è‰ç¨¿
- `POST /posts/drafts/:id/publish` - å‘å¸ƒè‰ç¨¿

**æ¨èç›¸å…³ï¼š**
- `GET /recommendations/posts/hot` - çƒ­é—¨å¸–å­
- `GET /recommendations/posts/trending` - è¶‹åŠ¿å¸–å­
- `GET /recommendations/personalized` - ä¸ªæ€§åŒ–æ¨è
- `GET /recommendations/topics` - çƒ­é—¨è¯é¢˜

---

## ğŸš€ éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

```env
# æ•°æ®åº“
DATABASE_URL=postgresql://user:password@localhost:5432/forum

# JWT
JWT_SECRET=your-secret-key
JWT_EXPIRATION=24h

# Session
SESSION_SECRET=your-session-secret

# è·¨åŸŸ
CORS_ORIGIN=http://localhost:3001

# ç¯å¢ƒ
NODE_ENV=production
```

### å¯åŠ¨å‘½ä»¤

**å¼€å‘ç¯å¢ƒï¼š**
```bash
pnpm run start:dev
```

**ç”Ÿäº§ç¯å¢ƒï¼š**
```bash
pnpm run build
pnpm run start
```

---

## âœ¨ é¡¹ç›®äº®ç‚¹

1. **å®Œæ•´çš„æ¨èç³»ç»Ÿ** - ä½¿ç”¨ Wilson Score å’Œæ—¶é—´è¡°å‡ç®—æ³•
2. **å®æ—¶ WebSocket** - Socket.io å®æ—¶é€šçŸ¥æ¨é€
3. **çµæ´»çš„æ”¶è—ç³»ç»Ÿ** - æ”¯æŒå¤šä¸ªæ”¶è—å¤¹å’Œå¤‡æ³¨
4. **è‡ªåŠ¨è‰ç¨¿ä¿å­˜** - ç”¨æˆ·å‹å¥½çš„ç¼–è¾‘ä½“éªŒ
5. **ç”¨æˆ·å…³æ³¨ç³»ç»Ÿ** - ç¤¾äº¤äº’åŠ¨åŠŸèƒ½
6. **ä¼šè¯ç®¡ç†** - Express Session + Cookie å®‰å…¨æ–¹æ¡ˆ
7. **æµè§ˆå™¨å…¼å®¹** - CORS å’Œç‰ˆæœ¬æ§åˆ¶é…ç½®

---

## ğŸ“‹ å¼€å‘è§„èŒƒ

### ä»£ç æ ¼å¼

- âœ… TypeScript ä¸¥æ ¼æ¨¡å¼
- âœ… NestJS å®˜æ–¹é£æ ¼æŒ‡å—
- âœ… DTO æ•°æ®éªŒè¯
- âœ… æ³¨é‡Šå’Œæ–‡æ¡£å®Œæ•´
- âœ… é”™è¯¯å¤„ç†è§„èŒƒ

### æäº¤è§„èŒƒ

é‡‡ç”¨ Conventional Commitsï¼š
- `feat:` æ–°åŠŸèƒ½
- `fix:` ä¿®å¤ Bug
- `docs:` æ–‡æ¡£æ›´æ–°
- `refactor:` é‡æ„
- `test:` æµ‹è¯•
- `chore:` æ„å»º/å·¥å…·

---

## ğŸ”„ Git æäº¤å†å²

æœ€è¿‘çš„æäº¤ï¼š

1. `feat: å®ç° WebSocket å®æ—¶é€šçŸ¥æ¨é€æ¨¡å—` - æ–°å¢ WebSocket åŠŸèƒ½
2. `feat: å®ç°æ¨èç³»ç»Ÿæ¨¡å—` - å®Œæˆæ¨èç®—æ³•
3. `feat: å®ç°å…³æ³¨ç³»ç»Ÿæ¨¡å—` - å®Œæˆç”¨æˆ·å…³æ³¨
4. `feat: å®ç°æ”¶è—ç³»ç»Ÿæ¨¡å—` - å®Œæˆå¸–å­æ”¶è—
5. `feat: å®ç°å¸–å­è‰ç¨¿åŠŸèƒ½` - å®Œæˆè‰ç¨¿ä¿å­˜
6. `feat: é…ç½®ä¼šè¯å’Œè·¨åŸŸæ”¯æŒ` - å®Œæˆä¼šè¯ç®¡ç†

---

## ğŸ“ åç»­å·¥ä½œ

### ä¸‹ä¸€é˜¶æ®µè®¡åˆ’ (v1.0.0)

- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ã€æŸ¥è¯¢ä¼˜åŒ–ï¼‰
- [ ] æ›´å¤šå•å…ƒæµ‹è¯•å’Œ E2E æµ‹è¯•
- [ ] Redis é›†æˆï¼ˆç¼“å­˜å’Œä¼šè¯å­˜å‚¨ï¼‰
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [ ] ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
- [ ] API æ–‡æ¡£è‡ªåŠ¨åŒ– (Swagger)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/architecture-design.md` - è¯¦ç»†çš„æ¶æ„è®¾è®¡
- `docs/api-documentation.md` - API æ¥å£æ–‡æ¡£
- `src/notifications/websocket-events.ts` - WebSocket äº‹ä»¶æ–‡æ¡£

---

## âœ… æ€»ç»“

**æ ¡å›­è®ºå›åå°ç³»ç»Ÿå·²å®Œå…¨å®ç° v0.4.0 æ‰€æœ‰åŠŸèƒ½ï¼**

- âœ… 5 ä¸ªæ–°åŠŸèƒ½æ¨¡å— (WebSocketã€è‰ç¨¿ã€æ”¶è—ã€å…³æ³¨ã€æ¨è)
- âœ… 15+ ä¸ªæ–°æ–‡ä»¶
- âœ… 1500+ è¡Œæ–°ä»£ç 
- âœ… 0 ä¸ª TypeScript ç¼–è¯‘é”™è¯¯
- âœ… 100% åŠŸèƒ½å®Œæˆåº¦

é¡¹ç›®ç°å·²å…·å¤‡æˆä¸ºç”Ÿäº§çº§åº”ç”¨çš„åŸºç¡€ï¼Œå¯è¿›å…¥ v1.0.0 ç”Ÿäº§ä¼˜åŒ–å’Œéƒ¨ç½²é˜¶æ®µã€‚
